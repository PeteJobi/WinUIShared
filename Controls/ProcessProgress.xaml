<?xml version="1.0" encoding="utf-8"?>
<UserControl
    x:Class="WinUIShared.Controls.ProcessProgress"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:timeline="using:WinUIShared.Controls"
    xmlns:converters="using:CommunityToolkit.WinUI.Converters"
    mc:Ignorable="d">

    <UserControl.Resources>
		<converters:BoolToVisibilityConverter x:Name="BoolToVisibilityConverter"/>
        <converters:BoolToObjectConverter x:Key="CloseOrCancelConverter" TrueValue="Close" FalseValue="Cancel"/>
        <converters:BoolToObjectConverter x:Key="ResumeOrPauseConverter" TrueValue="Resume" FalseValue="Pause"/>
        <converters:BoolToObjectConverter x:Key="ResumeOrPauseGlyphConverter" TrueValue="&#xE768;" FalseValue="&#xE784;"/>
    </UserControl.Resources>

	<RelativePanel Visibility="{x:Bind BeforeOperation, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}, ConverterParameter=True}" Padding="10">
		<TextBlock Name="CurrentTransitionLabel" Text="{x:Bind LeftTextPrimary, Mode=OneWay}"/>
		<TextBlock Name="OverallTourProgressText" RelativePanel.AlignHorizontalCenterWith="OverallTourProgress" Text="{x:Bind CenterTextPrimary, Mode=OneWay}"/>
		<TextBlock Name="CurrentStatus" RelativePanel.AlignRightWith="OverallTourProgress" Text="{x:Bind RightTextPrimary, Mode=OneWay}"/>
		<ProgressBar Name="OverallTourProgress" RelativePanel.AlignLeftWithPanel="True" Value="{x:Bind ProgressPrimary, Mode=OneWay}"
			RelativePanel.Below="CurrentTransitionLabel" RelativePanel.LeftOf="CancelSplit" Margin="0,4,0,0"/>
		<Button Name="CancelSplit" RelativePanel.AlignRightWithPanel="True" Margin="10,0,0,0" Width="120" Click="CancelOrClose_OnClick">
			<FlyoutBase.AttachedFlyout>
				<Flyout x:Name="CancelFlyout">
					<StackPanel Orientation="Horizontal">
						<TextBlock Style="{ThemeResource BaseTextBlockStyle}" VerticalAlignment="Center">Cancel process?</TextBlock>
						<Button ToolTipService.ToolTip="Done" Margin="10,0,0,0" Click="CancelProcess">
							<FontIcon Glyph="&#xE8FB;" />
						</Button>
					</StackPanel>
				</Flyout>
			</FlyoutBase.AttachedFlyout>
			<StackPanel Orientation="Horizontal">
				<FontIcon Glyph="&#xE711;" Margin="0,0,10,0" />
				<TextBlock VerticalAlignment="Center" Text="{x:Bind AfterOperation, Mode=OneWay, Converter={StaticResource CloseOrCancelConverter}}"/>
			</StackPanel>
		</Button>
		<TextBlock RelativePanel.Above="CurrentTourProgress" Text="{x:Bind LeftTextSecondary, Mode=OneWay}"/>
		<TextBlock Name="CurrentTourProgressText" RelativePanel.Above="CurrentTourProgress" RelativePanel.Below="OverallTourProgress"
			RelativePanel.AlignHorizontalCenterWith="CurrentTourProgress" Margin="0,30,0,0" Text="{x:Bind CenterTextSecondary, Mode=OneWay}"/>
		<TextBlock RelativePanel.Above="CurrentTourProgress" RelativePanel.AlignRightWith="CurrentTourProgress" Text="{x:Bind RightTextSecondary, Mode=OneWay}"/>
		<ProgressBar Name="CurrentTourProgress" RelativePanel.AlignLeftWithPanel="True" Value="{x:Bind ProgressSecondary, Mode=OneWay}"
			RelativePanel.AlignBottomWithPanel="True" RelativePanel.LeftOf="PauseTour" Margin="0,4,0,0"/>
		<Button Name="PauseTour" RelativePanel.AlignBottomWithPanel="True" RelativePanel.AlignRightWithPanel="True" Width="120" Margin="10,0,0,0"
			Click="PauseOrViewTour_OnClick">
			<Grid>
				<StackPanel Orientation="Horizontal" Visibility="{x:Bind AfterOperation, Mode=OneWay}">
					<FontIcon Glyph="&#xE8A7;" Margin="0,0,10,0" />
					<TextBlock VerticalAlignment="Center" Text="View"/>
				</StackPanel>
				<StackPanel Orientation="Horizontal" Visibility="{x:Bind DuringOperation, Mode=OneWay}">
					<FontIcon Glyph="{x:Bind Paused, Mode=OneWay, Converter={StaticResource ResumeOrPauseGlyphConverter}}" Margin="0,0,10,0" />
					<TextBlock VerticalAlignment="Center" Text="{x:Bind Paused, Mode=OneWay, Converter={StaticResource ResumeOrPauseConverter}}"/>
				</StackPanel>
			</Grid>
		</Button>
	</RelativePanel>    
</UserControl>
